/* truncated for brevity; SW included earlier */